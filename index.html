<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الإختبار الاول: مدخل عن القهوة المختصة</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Alexandria:wght@400;700&display=swap');

        body {
            direction: rtl; /* Right to left layout */
            font-family: 'Alexandria', sans-serif; /* Set font to Alexandria */
            margin-right: 5px; /* Decrease right indent */
        }
        h1 {
            text-align: center; /* Center the header */
            font-weight: bold; /* Make the header bold */
            margin-bottom: 70px; /* Add space between the header and the first question */
        }
        h3 {
            font-weight: normal; /* Ensure that the questions are not bold */
        }
        button {
            display: block; /* Makes button block-level to center */
            margin: 20px auto; /* Centers the button and adds spacing */
            font-size: 18px;
            padding: 15px 30px;
        }
    </style>
</head>
<body>
    <h1>الإختبار الاول: مدخل عن القهوة المختصة</h1>
    <form id="quizForm">
        <!-- Container for the shuffled questions -->
        <div id="questionsContainer"></div>

        <!-- Centered Button -->
        <button type="submit">إنهاء الاختبار</button>
    </form>

    <script>
        // Shuffle function
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Define questions and answers
        const quizData = [
            {
                question: " القهوة المختصة تشير إلى القهوة التي تحصل على تقييم 70 نقطة أو أكثر على مقياس من 100 نقطة من مُقيم معتمد",
                answers: [
                    { text: "صحيح", value: "صحيح" },
                    { text: "غير صحيح", value: "غير صحيح" }
                ]
            },
            {
                question: " هل العبارة التالية صحيحة ام خاطئة؟ 'القهوة هي احد أكثر السلع تداوًال في العالم، حيث تأتي في المرتبة الثانية بعد النفط الخام.'",
                answers: [
                    { text: "صحيحة", value: "صحيحة" },
                    { text: "خاطئة", value: "خاطئة" }
                ]
            },
            {
                question: " اي من المعالجات التالية قد نحصل على عمر افتراضي اطول لها بعد الحمص؟",
                answers: [
                    { text: "المعالجة المجففة", value: "المعالجة المجففة" },
                    { text: "المعالجة المغسولة", value: "المعالجة المغسولة" },
                    { text: "المعالجة العسلية", value: "المعالجة العسلية" }
                ]
            },
            {
                question: " المعالجة العسلية السوداء يتم تجفيفها لمدة تصل الى:",
                answers: [
                    { text: "١٥ يوم", value: "١٥ يوم" },
                    { text: "٢٠ يوم", value: "٢٠ يوم" },
                    { text: "٣٠ يوم", value: "٣٠ يوم" }
                ]
            },
            {
                question: " جهاز الـDepulper يتم استخدامه لـ:",
                answers: [
                    { text: "زالة الطبقة الهلامية من كرزة البن", value: "زالة الطبقة الهلامية من كرزة البن" },
                    { text: "ازالة القشرة الخارجية من كرزة البن", value: "ازالة القشرة الخارجية من كرزة البن" },
                    { text: "غسل كرزة البن", value: "غسل كرزة البن" }
                ]
            },
            {
                question: " للحفاظ على القهوة لمدة اطول ينصح بتخزينها بمكان بارد مثل داخل الثلاجة:",
                answers: [
                    { text: "ينصح بذلك", value: "ينصح بذلك" },
                    { text: "لا ينصح بذلك", value: "لا ينصح بذلك" }
                ]
            },
            {
                question: " ماهي فصيلة القهوة اللي تحتوي على قدر اعلى من الكافيين؟",
                answers: [
                    { text: "ارابيكا", value: "ارابيكا" },
                    { text: "روبستا", value: "روبستا" }
                ]
            },
            {
                question: " اي من طرق التحضير التالية تبقى القهوة على تواصل مع جميع الماء طوال فترة التحضير؟",
                answers: [
                    { text: "الاسبريسو", value: "الاسبريسو" },
                    { text: "الغمر الكلي", value: "الغمر الكلي" },
                    { text: "التقطير/الترشيح", value: "التقطير/الترشيح" }
                ]
            },
            {
                question: " اي من فصائل القهوة التالية تعتبر معرضة اكثر للامراض وحصادها اقل؟",
                answers: [
                    { text: "ارابيكا", value: "ارابيكا" },
                    { text: "روبستا", value: "روبستا" }
                ]
            },
            {
                question: " نسبة الرطوبة المطلوبة بعد عملية المعالجة تكون من...:",
                answers: [
                    { text: "١٢٪ الى ١٣٪", value: "١٢٪ الى ١٣٪" },
                    { text: "١٣٪ الى ١٥٪", value: "١٣٪ الى ١٥٪" },
                    { text: "١٠٪ الى ١٥٪", value: "١٠٪ الى ١٥٪" }
                ]
            }
        ];

        // Shuffle both the questions and their answers
        const shuffledQuestions = shuffle(quizData);
        shuffledQuestions.forEach(q => shuffle(q.answers));

        // Render the shuffled questions and answers to the DOM
        const questionsContainer = document.getElementById('questionsContainer');
        shuffledQuestions.forEach((q, index) => {
            const questionDiv = document.createElement('div');
            const questionTitle = document.createElement('h3');
            questionTitle.textContent = q.question;
            questionDiv.appendChild(questionTitle);

            q.answers.forEach(answer => {
                const label = document.createElement('label');
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = `q${index + 1}`;
                input.value = answer.value;
                input.required = true;
                label.appendChild(input);
                label.appendChild(document.createTextNode(` ${answer.text}`));
                questionDiv.appendChild(label);
                questionDiv.appendChild(document.createElement('br'));
            });

            questionsContainer.appendChild(questionDiv);
        });

        // Form submit logic remains the same
        document.getElementById('quizForm').onsubmit = function (e) {
            e.preventDefault();

            const formData = new FormData(this);
            const answers = {};
            formData.forEach((value, key) => {
                answers[key] = value;
            });

            // Correct answers mapping
            const correctAnswerKey = {
                q1: 'غير صحيح',
                q2: 'صحيحة',
                q3: 'المعالجة المجففة',
                q4: '٣٠ يوم',
                q5: 'زالة الطبقة الهلامية من كرزة البن',
                q6: 'لا ينصح بذلك',
                q7: 'روبستا',
                q8: 'الغمر الكلي',
                q9: 'ارابيكا',
                q10: '١٢٪ الى ١٣٪'
            };

            // Calculate score
            let correctAnswers = 0;
            Object.keys(answers).forEach(key => {
                if (answers[key] === correctAnswerKey[key]) {
                    correctAnswers++;
                }
            });

            // Calculate percentage
            const totalQuestions = 10;
            const score = (correctAnswers / totalQuestions) * 100;

            // Redirect to results page with score
            const encodedAnswers = encodeURIComponent(JSON.stringify(answers));
            window.location.href = `results.html?answers=${encodedAnswers}&score=${score.toFixed(2)}`;
        };

        // Reset form on reload
        window.onload = function () {
            document.getElementById('quizForm').reset();
        };
    </script>
</body>
</html>
